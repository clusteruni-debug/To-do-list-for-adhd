<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#667eea">
  <!-- ë³´ì•ˆ í—¤ë” -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%23667eea' width='100' height='100' rx='20'/%3E%3Ctext x='50' y='68' font-size='50' text-anchor='middle' fill='white'%3Eâš¡%3C/text%3E%3C/svg%3E">
  <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect fill='%23667eea' width='180' height='180' rx='36'/%3E%3Ctext x='90' y='122' font-size='90' text-anchor='middle' fill='white'%3Eâš¡%3C/text%3E%3C/svg%3E">
  <title>Navigator - ìƒì¡´í˜• í• ì¼ ê´€ë¦¬</title>

  <!-- Pretendard í°íŠ¸ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css">

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
    import { getAuth, signInWithPopup, signOut, GoogleAuthProvider, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
    import { initializeFirestore, persistentLocalCache, persistentSingleTabManager, doc, setDoc, getDoc, onSnapshot, runTransaction } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

    // Firebase ì„¤ì •
    // âš ï¸ ë³´ì•ˆ ì°¸ê³ : Firebase API í‚¤ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì‚¬ìš©ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
    // ì‹¤ì œ ë³´ì•ˆì€ Firebase Consoleì˜ Firestore Security Rulesì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.
    // ê¶Œì¥ ë³´ì•ˆ ê·œì¹™ (Firebase Console > Firestore > Rules):
    // rules_version = '2';
    // service cloud.firestore {
    //   match /databases/{database}/documents {
    //     match /users/{userId} {
    //       allow read, write: if request.auth != null && request.auth.uid == userId;
    //     }
    //   }
    // }
    const firebaseConfig = {
      apiKey: "AIzaSyDryb8MH0Mwkh1yP8yPCjdTbEvjr97mmmE",
      authDomain: "navigator-todo.firebaseapp.com",
      projectId: "navigator-todo",
      storageBucket: "navigator-todo.firebasestorage.app",
      messagingSenderId: "1020977741609",
      appId: "1:1020977741609:web:32ec5ad48329f80a3f0138"
    };

    // Firebase ì´ˆê¸°í™”
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = initializeFirestore(app, {
      localCache: persistentLocalCache({
        tabManager: persistentSingleTabManager({ forceOwnership: true })
      })
    });
    const provider = new GoogleAuthProvider();

    // ì „ì—­ ë³€ìˆ˜ë¡œ ë…¸ì¶œ
    window.firebaseAuth = auth;
    window.firebaseDb = db;
    window.firebaseProvider = provider;
    window.firebaseSignIn = signInWithPopup;
    window.firebaseSignOut = signOut;
    window.firebaseDoc = doc;
    window.firebaseSetDoc = setDoc;
    window.firebaseGetDoc = getDoc;
    window.firebaseRunTransaction = runTransaction;
    window.firebaseOnSnapshot = onSnapshot;
    window.firebaseOnAuthStateChanged = onAuthStateChanged;

    // Firebase ì¤€ë¹„ ì™„ë£Œ ì´ë²¤íŠ¸
    window.dispatchEvent(new Event('firebase-ready'));
  </script>
  <link rel="stylesheet" href="css/navigator.css">
</head>
<body>
  <a href="#root" class="skip-link">ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°</a>
  <div id="root" role="main"></div>

  <!-- ì™„ë£Œ ì• ë‹ˆë©”ì´ì…˜ ì˜¤ë²„ë ˆì´ -->
  <div id="completion-overlay" class="completion-overlay">
    <div class="completion-content">
      <div class="completion-check">âœ“</div>
      <div class="completion-text">ì™„ë£Œ!</div>
      <div id="completion-streak" class="completion-streak"></div>
      <div id="completion-task-title" class="completion-task-title"></div>
    </div>
  </div>

  <!-- íŒŒì¼ ì—…ë¡œë“œìš© íˆë“  ì¸í’‹ -->
  <input type="file" id="file-import" class="hidden-input" accept=".json">

  <!-- ì‹¤ì œ ì†Œìš”ì‹œê°„ ì…ë ¥ ëª¨ë‹¬ -->
  <div id="time-input-modal" class="time-input-modal">
    <div class="time-input-header">
      <span class="time-input-title">â±ï¸ ì‹¤ì œë¡œ ì–¼ë§ˆë‚˜ ê±¸ë ¸ë‚˜ìš”?</span>
      <button class="modal-close" onclick="closeTimeInputModal()">Ã—</button>
    </div>
    <div class="time-input-options">
      <button class="time-option-btn" onclick="saveActualTime(2)">2ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(5)">5ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(10)">10ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(15)">15ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(20)">20ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(30)">30ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(45)">45ë¶„</button>
      <button class="time-option-btn" onclick="saveActualTime(60)">1ì‹œê°„</button>
    </div>
    <div class="time-input-custom">
      <input type="number" id="custom-time-input" placeholder="ì§ì ‘ ì…ë ¥ (ë¶„)" min="1" max="480">
      <button class="btn btn-primary" onclick="saveActualTime(parseInt(document.getElementById('custom-time-input').value))">ì €ì¥</button>
      <button class="btn btn-secondary" onclick="closeTimeInputModal()">ê±´ë„ˆë›°ê¸°</button>
    </div>
  </div>

  <!-- ì£¼ê°„ ë¦¬ë·° ëª¨ë‹¬ -->
  <div id="weekly-review-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content weekly-review-modal">
      <div class="modal-header">
        <h2 id="weekly-review-title">ğŸ“Š ì´ë²ˆ ì£¼ ë¦¬ë·°</h2>
        <button class="modal-close" onclick="closeWeeklyReview()">Ã—</button>
      </div>
      <div id="weekly-review-content" class="modal-body">
        <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeWeeklyReview()">ë‚˜ì¤‘ì—</button>
        <button class="btn btn-primary" onclick="saveWeeklyPlan()">ì €ì¥í•˜ê¸°</button>
      </div>
    </div>
  </div>

  <!-- ë³¸ì—… í”„ë¡œì íŠ¸ ì…ë ¥ ëª¨ë‹¬ -->
  <div id="work-input-modal" class="work-modal">
    <div class="work-modal-content">
      <div class="work-modal-title" id="work-modal-title">ìƒˆ í”„ë¡œì íŠ¸</div>
      <div id="work-modal-body">
        <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
      </div>
      <div class="work-modal-actions">
        <button class="cancel" onclick="closeWorkModal()">ì·¨ì†Œ</button>
        <button class="confirm" onclick="confirmWorkModal()">í™•ì¸</button>
      </div>
    </div>
  </div>

  <!-- ë¹ ë¥¸ ìˆ˜ì • ëª¨ë‹¬ (íƒ­ ì´ë™ ì—†ì´) -->
  <div id="quick-edit-modal" class="work-modal">
    <div class="work-modal-content" style="max-width: 400px;">
      <div class="work-modal-title">âœï¸ ì‘ì—… ìˆ˜ì •</div>
      <div id="quick-edit-body">
        <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
      </div>
      <div class="work-modal-actions">
        <button class="cancel" onclick="closeQuickEditModal()">ì·¨ì†Œ</button>
        <button class="confirm" onclick="saveQuickEdit()">ì €ì¥</button>
      </div>
      <div style="text-align: center; margin-top: 12px; display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
        <button class="btn-small" onclick="openFullEdit()" style="background: var(--bg-tertiary); color: var(--text-secondary);">
          ğŸ“ ìƒì„¸ í¸ì§‘
        </button>
        <button class="btn-small" onclick="openArticleEditor(appState.quickEditTaskId)" style="background: var(--bg-tertiary); color: var(--text-secondary);">
          âœï¸ ì•„í‹°í´ ì‘ì„±
        </button>
      </div>
    </div>
  </div>

  <!-- í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë„ì›€ë§ (PC) -->
  <button class="shortcuts-toggle" onclick="toggleShortcutsHelp()" title="ë‹¨ì¶•í‚¤ ë„ì›€ë§">âŒ¨ï¸</button>
  <div id="shortcuts-help" class="shortcuts-help">
    <div class="shortcuts-help-title">
      <span>âŒ¨ï¸ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤</span>
      <button class="shortcuts-help-close" onclick="toggleShortcutsHelp()">Ã—</button>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ìƒˆ ì‘ì—… ì¶”ê°€</span>
      <span class="shortcut-key">N</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ê²€ìƒ‰</span>
      <span class="shortcut-key">Ctrl+F</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ì²« Task ì™„ë£Œ</span>
      <span class="shortcut-key">Ctrl+D</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ì•¡ì…˜ íƒ­</span>
      <span class="shortcut-key">1</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ì—…ë¬´ íƒ­</span>
      <span class="shortcut-key">2</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ì´ë²¤íŠ¸ íƒ­</span>
      <span class="shortcut-key">3</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ëŒ€ì‹œë³´ë“œ íƒ­</span>
      <span class="shortcut-key">4</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ì „ì²´ íƒ­</span>
      <span class="shortcut-key">5</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ê¸°ë¡ íƒ­</span>
      <span class="shortcut-key">6</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ì…”í‹€ í† ê¸€</span>
      <span class="shortcut-key">S</span>
    </div>
    <div class="shortcut-item">
      <span class="shortcut-desc">ë„ì›€ë§</span>
      <span class="shortcut-key">?</span>
    </div>
  </div>

  <!-- JS ëª¨ë“ˆ (ë¡œë“œ ìˆœì„œ ì¤‘ìš”) -->
  <script src="js/utils.js"></script>
  <script src="js/state.js"></script>
  <script src="js/firebase-sync.js"></script>
  <script src="js/tasks.js"></script>
  <script src="js/tasks-revenue.js"></script>
  <script src="js/tasks-insights.js"></script>
  <script src="js/tasks-history.js"></script>
  <script src="js/actions-complete.js"></script>
  <script src="js/actions-edit.js"></script>
  <script src="js/actions-ui.js"></script>
  <script src="js/actions.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/ui-data.js"></script>
  <script src="js/ui-completion-log.js"></script>
  <script src="js/ui-onboarding.js"></script>
  <script src="js/render-forms.js"></script>
  <script src="js/render-action.js"></script>
  <script src="js/render-events.js"></script>
  <script src="js/render-life.js"></script>
  <script src="js/render-dashboard.js"></script>
  <script src="js/render-all.js"></script>
  <script src="js/render-settings.js"></script>
  <script src="js/render.js"></script>
  <script src="js/globals.js"></script>
  <script src="js/work-data.js"></script>
  <script src="js/work-modal.js"></script>
  <script src="js/work-actions.js"></script>
  <script src="js/work.js"></script>
  <script src="js/pwa.js"></script>
  <script src="js/pomodoro.js"></script>
  <script src="js/commute.js"></script>
  <script src="js/rhythm-medication.js"></script>
  <script src="js/rhythm-merge.js"></script>
  <script src="js/rhythm-stats.js"></script>
  <script src="js/rhythm-history.js"></script>
  <script src="js/rhythm.js"></script>
  <script src="js/command-palette.js"></script>
  <script src="js/init.js"></script>
</body>
</html>
